<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="##1234567891011121314151617$ geth --datadir eth-amas console --nodiscover --rpc">
<meta property="og:type" content="article">
<meta property="og:title" content="ETH RPC GUIDE">
<meta property="og:url" content="http://yoursite.com/2018/01/05/eth-rpc-guide/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="##1234567891011121314151617$ geth --datadir eth-amas console --nodiscover --rpc">
<meta property="og:locale" content="zh-cn">
<meta property="og:updated_time" content="2018-01-09T10:25:32.581Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="ETH RPC GUIDE">
<meta name="twitter:description" content="##1234567891011121314151617$ geth --datadir eth-amas console --nodiscover --rpc">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>ETH RPC GUIDE</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Inici</a></li>
         
          <li><a href="/about/">Qui som</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/projects_url">Projectes</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/01/15/eth-ganache/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/01/05/start-githubpage/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Post Anterior</span>
      <span id="i-next" class="info" style="display:none;">Post Següent</span>
      <span id="i-top" class="info" style="display:none;">Adalt</span>
      <span id="i-share" class="info" style="display:none;">Compartir Post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/01/05/eth-rpc-guide/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&text=ETH RPC GUIDE"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&title=ETH RPC GUIDE"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&is_video=false&description=ETH RPC GUIDE"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ETH RPC GUIDE&body=Check out this article: http://yoursite.com/2018/01/05/eth-rpc-guide/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&title=ETH RPC GUIDE"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&title=ETH RPC GUIDE"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&title=ETH RPC GUIDE"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&title=ETH RPC GUIDE"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&name=ETH RPC GUIDE&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.</span> <span class="toc-text">智能合约</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.</span> <span class="toc-text">啥是智能合约</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.</span> <span class="toc-text">EVM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.3.</span> <span class="toc-text">DApps</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">2.</span> <span class="toc-text">DApps安装开发环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">3.</span> <span class="toc-text">安装testrpc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">4.</span> <span class="toc-text">安装truffle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.</span> <span class="toc-text">建立truffle工程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">5.1.</span> <span class="toc-text">编写智能合约</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">5.2.</span> <span class="toc-text">函数种类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">5.3.</span> <span class="toc-text">在私有链上发布DApps</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">6.</span> <span class="toc-text">Ethereum 协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">7.</span> <span class="toc-text">交易</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">7.1.</span> <span class="toc-text">1. 构造交易对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">7.2.</span> <span class="toc-text">2. 为交易签名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">7.3.</span> <span class="toc-text">3. 本地交易合法性验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">7.4.</span> <span class="toc-text">4. 广播合法交易</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">7.5.</span> <span class="toc-text">5. 矿工节点接受交易</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">7.6.</span> <span class="toc-text">7. 矿工</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">8.</span> <span class="toc-text">参考</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        ETH RPC GUIDE
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Hexo</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-01-05T12:04:57.000Z" itemprop="datePublished">2018-01-05</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>##<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">$ geth --datadir eth-amas console --nodiscover --rpc                                                                                                                                                ~/.ethereum/ext</span><br><span class="line">INFO [01-05|16:58:28] Starting peer-to-peer node               instance=Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9.2</span><br><span class="line">INFO [01-05|16:58:28] Allocated cache and file handles         database=/home/amas/.ethereum/ext/eth-amas/geth/chaindata cache=128 handles=1024</span><br><span class="line">INFO [01-05|16:58:28] Initialised chain configuration          config=<span class="string">"&#123;ChainID: 12345 Homestead: 0 DAO: &lt;nil&gt; DAOSupport: false EIP150: &lt;nil&gt; EIP155: 0 EIP158: 0 Byzantium: &lt;nil&gt; Engine: unknown&#125;"</span></span><br><span class="line">INFO [01-05|16:58:28] Disk storage enabled <span class="keyword">for</span> ethash caches   dir=/home/amas/.ethereum/ext/eth-amas/geth/ethash count=3</span><br><span class="line">INFO [01-05|16:58:28] Disk storage enabled <span class="keyword">for</span> ethash DAGs     dir=/home/amas/.ethash                            count=2</span><br><span class="line">INFO [01-05|16:58:28] Initialising Ethereum protocol           versions=<span class="string">"[63 62]"</span> network=1</span><br><span class="line">INFO [01-05|16:58:28] Loaded most recent <span class="built_in">local</span> header          number=0 <span class="built_in">hash</span>=3b5eb5…99e545 td=20</span><br><span class="line">INFO [01-05|16:58:28] Loaded most recent <span class="built_in">local</span> full block      number=0 <span class="built_in">hash</span>=3b5eb5…99e545 td=20</span><br><span class="line">INFO [01-05|16:58:28] Loaded most recent <span class="built_in">local</span> fast block      number=0 <span class="built_in">hash</span>=3b5eb5…99e545 td=20</span><br><span class="line">INFO [01-05|16:58:28] Loaded <span class="built_in">local</span> transaction journal         transactions=0 dropped=0</span><br><span class="line">INFO [01-05|16:58:28] Regenerated <span class="built_in">local</span> transaction journal    transactions=0 accounts=0</span><br><span class="line">INFO [01-05|16:58:28] Starting P2P networking</span><br><span class="line">INFO [01-05|16:58:28] RLPx listener up                         self=<span class="string">"enode://dc3f47a3869559b71760bfe06b4c969a5bdc4fa468d5fc4955eb4d81aa32322a20df5bff4bc081ba19be7ff06b77e8e00bc747c60e219b58605cf35bb5794ef5@[::]:30303?discport=0"</span></span><br><span class="line">INFO [01-05|16:58:28] IPC endpoint opened: /home/amas/.ethereum/ext/eth-amas/geth.ipc  <span class="comment"># IPC 接入点</span></span><br><span class="line">INFO [01-05|16:58:28] HTTP endpoint opened: http://127.0.0.1:8545 <span class="comment"># JSON-RPC HTTP 接入点</span></span><br><span class="line">Welcome to the Geth JavaScript console!</span><br></pre></td></tr></table></figure></p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 可以先测试一下8545端口是否可用</span></span><br><span class="line">$ netcat -v 127.0.0.1 8545</span><br><span class="line">localhost [127.0.0.1] 8545 open</span><br><span class="line"></span><br><span class="line">$ curl -H <span class="string">"Content-Type: application/json"</span> --data <span class="string">'&#123;"jsonrpc":"2.0","method":"web3_clientVersion","params":[],"id":42&#125;'</span> http://127.0.0.1:8545</span><br><span class="line">&#123;<span class="string">"jsonrpc"</span>:<span class="string">"2.0"</span>,<span class="string">"id"</span>:67,<span class="string">"result"</span>:<span class="string">"Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9.2"</span>&#125;</span><br></pre></td></tr></table></figure>
<h2><span id="zhi-neng-he-yue">智能合约</span></h2><h3><span id="sha-shi-zhi-neng-he-yue">啥是智能合约</span></h3><p>智能合约就是一段可以被机器执行的代码</p>
<h3><span id="evm">EVM</span></h3><p>EVM是用来执行智能合约的虚拟机, 执行智能合约需要消耗gas</p>
<ul>
<li>Solidity : JavaScript</li>
<li>Serpent : Python Likee</li>
<li>LLL : Lisp Like</li>
<li>Mutan : 已经废弃</li>
</ul>
<h3><span id="dapps">DApps</span></h3><p>任何人都可以向太坊网络中丢入自己的智能合约，如果把以太坊想象为一个应用市场，那么每个合约类似于一个App,<br>所以DApps很形象的说明了以太坊智能合约，他们是一个意思。</p>
<h2><span id="dapps-an-zhuang-kai-fa-huan-jing">DApps安装开发环境</span></h2><h2><span id="an-zhuang-testrpc">安装testrpc</span></h2><ul>
<li>公有链上发布DApps需要同步整个公有链，而且运行还需要以太币，对于穷人很不划算</li>
<li>运行geth创建一个私有链，并在上面调试发布比较繁琐，这个后面再说</li>
<li>testrpc就是一个</li>
</ul>
<h2><span id="an-zhuang-truffle">安装truffle</span></h2><p>truffle是号称最流行的以太坊合约开发，<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ sudo npm install -g truffle</span><br><span class="line"></span><br><span class="line"># 安装solc</span><br><span class="line"># 安装完truffle实际上就已经安装了solc, 不过有时候我们可能会使用solc的命令行工具，所以可以安装一下</span><br><span class="line">$ sudo npm install -g solc</span><br><span class="line">$ solcjs</span><br></pre></td></tr></table></figure></p>
<h2><span id="jian-li-truffle-gong-cheng">建立truffle工程</span></h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">$ mkdir smart_contract</span><br><span class="line">$ cd smart_contract</span><br><span class="line">$ truffle init</span><br><span class="line">Downloading...</span><br><span class="line">Unpacking...</span><br><span class="line">Setting up...</span><br><span class="line">Unbox successful. Sweet!</span><br><span class="line"></span><br><span class="line">Commands:</span><br><span class="line"></span><br><span class="line">  Compile:        truffle compile</span><br><span class="line">  Migrate:        truffle migrate</span><br><span class="line">  Test contracts: truffle test</span><br><span class="line"></span><br><span class="line">$ tree .</span><br><span class="line">.</span><br><span class="line">├── contracts</span><br><span class="line">│   └── Migrations.sol</span><br><span class="line">├── migrations</span><br><span class="line">│   └── 1_initial_migration.js</span><br><span class="line">├── test</span><br><span class="line">├── truffle-config.js</span><br><span class="line">└── truffle.js</span><br></pre></td></tr></table></figure>
<blockquote>
<p>*.sol文件就是智能合约的源代码了</p>
</blockquote>
<figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^<span class="number">0.4</span><span class="number">.17</span>;</span><br><span class="line"></span><br><span class="line">contract Migrations &#123;</span><br><span class="line">  address public owner;</span><br><span class="line">  uint public last_completed_migration;</span><br><span class="line"></span><br><span class="line">  modifier restricted() &#123;</span><br><span class="line">    <span class="keyword">if</span> (msg.sender == owner) _;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">Migrations</span>(<span class="params"></span>) <span class="title">public</span> </span>&#123;</span><br><span class="line">    owner = msg.sender;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">setCompleted</span>(<span class="params">uint completed</span>) <span class="title">public</span> <span class="title">restricted</span> </span>&#123;</span><br><span class="line">    last_completed_migration = completed;</span><br><span class="line">  &#125;</span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">function</span> <span class="title">upgrade</span>(<span class="params">address new_address</span>) <span class="title">public</span> <span class="title">restricted</span> </span>&#123;</span><br><span class="line">    Migrations upgraded = Migrations(new_address);</span><br><span class="line">    upgraded.setCompleted(last_completed_migration);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line">$ sudo npm install -g ethereumjs-testrpc</span><br><span class="line">$ testrpc</span><br><span class="line">EthereumJS TestRPC v6.0.3 (ganache-core: 2.0.2)</span><br><span class="line"></span><br><span class="line">Available Accounts</span><br><span class="line">==================</span><br><span class="line">(0) 0xab995a6bf26db4dfcfc927d01967ef5973e9da63</span><br><span class="line">(1) 0xb04d5a66e078cb8e8f031c414619216c72d4f3a3</span><br><span class="line">(2) 0xaf7f4656106b25c6093233ab66f40d8e03f93926</span><br><span class="line">(3) 0xd584c07964850c66ce26efd69a7e6bc153e8ece6</span><br><span class="line">(2) 0xaf7f4656106b25c6093233ab66f40d8e03f93926</span><br><span class="line">(3) 0xd584c07964850c66ce26efd69a7e6bc153e8ece6</span><br><span class="line">(4) 0x807845d6d44de79cda137068e3e72175ce0d27ac</span><br><span class="line">(5) 0x60097a1896719d0b73233c6d0159984f65d7d55b</span><br><span class="line">(6) 0xf9cb27e1018ec970d004bf7cf319e0218e63d739</span><br><span class="line">(7) 0x0f8a0ed850e6b75a6bd712f7b0e03a4255b0e035</span><br><span class="line">(8) 0x3cc21e470a8d900d1a932eb2383390fdb19fdfa1</span><br><span class="line">(9) 0xa0df7ad1041d9eb64a96f8a02f28ffb202373f1b</span><br><span class="line"></span><br><span class="line">Private Keys</span><br><span class="line">==================</span><br><span class="line">(0) 3505325226a3e46493312c7014f1fc471095f7b9ddaefb2b55c9ffdfd7630810</span><br><span class="line">(1) c0c4b54755c0edd0ae85a9009faaf10e1fbccbd4ce092c0ca34a12acea00ed2c</span><br><span class="line">(2) 386bf24b68a4381681bc386449772cc4518dddf46979f4801cf0795f19c4c81f</span><br><span class="line">(3) 4b18f70f1d4159ce3c980ea139c66c7fc42c7f9e5af117327cababfc32d347cd</span><br><span class="line">(4) db189ec770c5659b1a011ae3a014729cfb95acae756f23b8e45044450ad42bc5</span><br><span class="line">(5) dc91f3ce1c33d89caed7a60b824dd3212eeec741509cc07a24cc5976b9b73393</span><br><span class="line">(6) d08e72f7a511542ef787fd9e03cbf9b8738ccd1d03a7d70cb8933c458d26321e</span><br><span class="line">(7) 68ad92ca07665653c7f23d3a38db23ca500f0d5070d3050372070e7648f4daf7</span><br><span class="line">(8) 89c2328653b460fc6cbadd48ee8e5151a8f944fa190e443ab5d4a4a8a6497cff</span><br><span class="line">(9) ffabcd6873502895dbaa13adb32fb7e7ea48082c9f0fd589fac081e594a9a2e9</span><br><span class="line"></span><br><span class="line">HD Wallet</span><br><span class="line">==================</span><br><span class="line">Mnemonic:      reduce oblige various segment myth few extra gentle achieve flash tape small</span><br><span class="line">Base HD Path:  m/44&apos;/60&apos;/0&apos;/0/&#123;account_index&#125;</span><br><span class="line"></span><br><span class="line">Listening on localhost:8545</span><br></pre></td></tr></table></figure>
<p>编译:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ truffle compile</span><br><span class="line">Compiling ./contracts/Migrations.sol...</span><br><span class="line">Writing artifacts to ./build/contracts</span><br><span class="line"></span><br><span class="line"># 编译后的结果保存在build目录中</span><br><span class="line">$ tree.build</span><br><span class="line">build</span><br><span class="line">└── contracts</span><br><span class="line">    └── Migrations.json</span><br></pre></td></tr></table></figure></p>
<p>运行:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">$ truffle migrate</span><br><span class="line">Error: No network specified. Cannot determine current network.</span><br><span class="line">    at Object.detect (/usr/lib/node_modules/truffle/build/cli.bundled.js:41338:23)</span><br><span class="line">    at /usr/lib/node_modules/truffle/build/cli.bundled.js:202239:19</span><br><span class="line">    at finished (/usr/lib/node_modules/truffle/build/cli.bundled.js:41266:9)</span><br><span class="line">    at /usr/lib/node_modules/truffle/build/cli.bundled.js:200593:14</span><br><span class="line">    at /usr/lib/node_modules/truffle/build/cli.bundled.js:63299:7</span><br><span class="line">    at /usr/lib/node_modules/truffle/build/cli.bundled.js:165077:9</span><br><span class="line">    at /usr/lib/node_modules/truffle/build/cli.bundled.js:161676:16</span><br><span class="line">    at replenish (/usr/lib/node_modules/truffle/build/cli.bundled.js:162196:25)</span><br><span class="line">    at iterateeCallback (/usr/lib/node_modules/truffle/build/cli.bundled.js:162186:17)</span><br><span class="line">    at /usr/lib/node_modules/truffle/build/cli.bundled.js:162161:16</span><br><span class="line"># 这个因为我们没有指定合约发布的网络, 需要在truffle.js中指定</span><br></pre></td></tr></table></figure></p>
<ul>
<li><a href="http://truffleframework.com/docs/advanced/configuration" target="_blank" rel="noopener">truffle配置说明</a></li>
</ul>
<p>truffle.js:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">module.exports = &#123;</span><br><span class="line">    // See &lt;http://truffleframework.com/docs/advanced/configuration&gt;</span><br><span class="line">    // to customize your Truffle configuration!</span><br><span class="line">    networks: &#123;</span><br><span class="line">        development: &#123;</span><br><span class="line">            host: &quot;localhost&quot;,</span><br><span class="line">            port: 8545,     // 这个端口改成testrpc监听的端口就可以</span><br><span class="line">            network_id: &quot;*&quot; // Match any network id</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ truffle migrate </span><br><span class="line">Using network &apos;development&apos;.</span><br><span class="line"></span><br><span class="line">Network up to date.</span><br></pre></td></tr></table></figure>
<h3><span id="bian-xie-zhi-neng-he-yue">编写智能合约</span></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ truffle create contract HelloWorld </span><br><span class="line"># 多了一个contracts/HelloWorld.sol</span><br></pre></td></tr></table></figure>
<p>HelloWorld.sol:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">pragma solidity ^0.4.4;</span><br><span class="line"></span><br><span class="line">contract HelloWorld &#123;</span><br><span class="line">  function HelloWorld() &#123;</span><br><span class="line">    // constructor</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3><span id="han-shu-chong-lei">函数种类</span></h3><table>
<thead>
<tr>
<th>类型</th>
</tr>
</thead>
<tbody>
<tr>
<td>Read-only (constant) functions</td>
</tr>
<tr>
<td>Transactional functions</td>
</tr>
</tbody>
</table>
<h3><span id="zai-si-you-lian-shang-fa-bu-dapps">在私有链上发布DApps</span></h3><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 先来建一个私有链，稍后我们在私有链上编写智能合约</span></span><br><span class="line">$ geth init helloworld-genesis.json --datadir bc_helloworld</span><br><span class="line">WARN [01-09|10:56:25] No etherbase <span class="built_in">set</span> and no accounts found as default </span><br><span class="line">INFO [01-09|10:56:25] Allocated cache and file handles         database=/src/bc/bc_helloworld/geth/chaindata cache=16 handles=16</span><br><span class="line">INFO [01-09|10:56:25] Writing custom genesis block </span><br><span class="line">INFO [01-09|10:56:25] Successfully wrote genesis state         database=chaindata                            <span class="built_in">hash</span>=3b5eb5…99e545</span><br><span class="line">INFO [01-09|10:56:25] Allocated cache and file handles         database=/src/bc/bc_helloworld/geth/lightchaindata cache=16 handles=16</span><br><span class="line">INFO [01-09|10:56:25] Writing custom genesis block </span><br><span class="line">INFO [01-09|10:56:25] Successfully wrote genesis state         database=lightchaindata                            <span class="built_in">hash</span>=3b5eb5…99e545</span><br><span class="line"></span><br><span class="line"><span class="comment"># 启动geth运行起这个ETH节点</span></span><br><span class="line">$ geth --datadir bc_helloworld --nodiscover console</span><br><span class="line">WARN [01-09|10:58:29] No etherbase <span class="built_in">set</span> and no accounts found as default</span><br><span class="line">INFO [01-09|10:58:29] Starting peer-to-peer node               instance=Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9.2</span><br><span class="line">INFO [01-09|10:58:29] Allocated cache and file handles         database=/src/bc/bc_helloworld/geth/chaindata cache=128 handles=1024</span><br><span class="line">INFO [01-09|10:58:29] Initialised chain configuration          config=<span class="string">"&#123;ChainID: 19830709 Homestead: 0 DAO: &lt;nil&gt; DAOSupport: false EIP150: &lt;nil&gt; EIP155: 0 EIP158: 0 Byzantium: &lt;nil&gt; Engine: unknown&#125;"</span></span><br><span class="line">INFO [01-09|10:58:29] Disk storage enabled <span class="keyword">for</span> ethash caches   dir=/src/bc/bc_helloworld/geth/ethash count=3</span><br><span class="line">INFO [01-09|10:58:29] Disk storage enabled <span class="keyword">for</span> ethash DAGs     dir=/home/amas/.ethash                count=2</span><br><span class="line">INFO [01-09|10:58:29] Initialising Ethereum protocol           versions=<span class="string">"[63 62]"</span> network=1</span><br><span class="line">INFO [01-09|10:58:29] Loaded most recent <span class="built_in">local</span> header          number=0 <span class="built_in">hash</span>=3b5eb5…99e545 td=20</span><br><span class="line">INFO [01-09|10:58:29] Loaded most recent <span class="built_in">local</span> full block      number=0 <span class="built_in">hash</span>=3b5eb5…99e545 td=20</span><br><span class="line">INFO [01-09|10:58:29] Loaded most recent <span class="built_in">local</span> fast block      number=0 <span class="built_in">hash</span>=3b5eb5…99e545 td=20</span><br><span class="line">INFO [01-09|10:58:29] Loaded <span class="built_in">local</span> transaction journal         transactions=0 dropped=0</span><br><span class="line">INFO [01-09|10:58:29] Regenerated <span class="built_in">local</span> transaction journal    transactions=0 accounts=0</span><br><span class="line">INFO [01-09|10:58:29] Starting P2P networking</span><br><span class="line">INFO [01-09|10:58:29] RLPx listener up                         self=<span class="string">"enode://116ea2d28bdee9cec96e613e2f7984bdde85e44f1703a47cff778cb5f8088a51a473db6ca0adcc934a9f656787e676b796cb6c76caa424b6dfc7e8025358700f@[::]:30303?discport=0"</span></span><br><span class="line">INFO [01-09|10:58:29] IPC endpoint opened: /src/bc/bc_helloworld/geth.ipc</span><br><span class="line">Welcome to the Geth JavaScript console!</span><br><span class="line"></span><br><span class="line">instance: Geth/v1.7.3-stable-4bb3c89d/linux-amd64/go1.9.2</span><br><span class="line"> modules: admin:1.0 debug:1.0 eth:1.0 miner:1.0 net:1.0 personal:1.0 rpc:1.0 txpool:1.0 web3:1.0</span><br><span class="line">&gt;</span><br><span class="line"><span class="comment">#</span></span><br></pre></td></tr></table></figure>
<h2><span id="ethereum-xie-yi">Ethereum 协议</span></h2><pre><code>* Message Call
* Transaction Call : A kind of message call
</code></pre><h2><span id="jiao-yi">交易</span></h2><h3><span id="1-gou-zao-jiao-yi-dui-xiang">1. 构造交易对象</span></h3><p>交易对象大概是这个样子:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">&#123;</span><br><span class="line">  from: ...,</span><br><span class="line">  to: ...,</span><br><span class="line">  value: ...,</span><br><span class="line">  gas: ...,</span><br><span class="line">  data: ...,</span><br><span class="line">  gasPrice: ...,</span><br><span class="line">  nonce: ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<table>
<thead>
<tr>
<th>字段</th>
<th>含义</th>
<th>作用</th>
</tr>
</thead>
<tbody>
<tr>
<td>from</td>
</tr>
<tr>
<td>to</td>
</tr>
<tr>
<td>gas</td>
</tr>
<tr>
<td>data</td>
</tr>
<tr>
<td>gasPrice</td>
</tr>
<tr>
<td>nonce</td>
</tr>
</tbody>
</table>
<h3><span id="2-wei-jiao-yi-qian-ming">2. 为交易签名</span></h3><h3><span id="3-ben-di-jiao-yi-he-fa-xing-yan-zheng">3. 本地交易合法性验证</span></h3><h3><span id="4-guang-bo-he-fa-jiao-yi">4. 广播合法交易</span></h3><h3><span id="5-kuang-gong-jie-dian-jie-shou-jiao-yi">5. 矿工节点接受交易</span></h3><h3><span id="7-kuang-gong">7. 矿工</span></h3><h2><span id="can-kao">参考</span></h2><ul>
<li><a href="https://blog.zeppelin.solutions/the-hitchhikers-guide-to-smart-contracts-in-ethereum-848f08001f05" target="_blank" rel="noopener"></a></li>
<li><a href="https://github.com/trufflesuite/truffle/releases/tag/v4.0.0" target="_blank" rel="noopener">Truffle Release Notes</a></li>
<li><a href="https://medium.com/@mvmurthy/full-stack-hello-world-voting-ethereum-dapp-tutorial-part-1-40d2d0d807c2" target="_blank" rel="noopener">https://medium.com/@mvmurthy/full-stack-hello-world-voting-ethereum-dapp-tutorial-part-1-40d2d0d807c2</a></li>
<li><a href="https://metamask.io/" target="_blank" rel="noopener">MetaMask</a></li>
<li><a href="http://truffleframework.com/docs/getting_started/installation" target="_blank" rel="noopener">Truffle使用手册</a></li>
<li><a href="https://github.com/trufflesuite/ganache-cli#install" target="_blank" rel="noopener">TestRpc使用手册</a></li>
<li><a href="https://www.parity.io/" target="_blank" rel="noopener">Parity</a></li>
<li><a href="http://truffleframework.com/ganache/" target="_blank" rel="noopener">Ganache</a></li>
<li><a href="https://medium.com/blockchannel/life-cycle-of-an-ethereum-transaction-e5c66bae0f6e" target="_blank" rel="noopener">以太坊交易的生命周期</a></li>
<li><a href="https://github.com/ethereumjs/ethereumjs-vm" target="_blank" rel="noopener">JavaScript版EVM:etherumjs-vm</a></li>
</ul>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Inici</a></li>
         
          <li><a href="/about/">Qui som</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/projects_url">Projectes</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.</span> <span class="toc-text">智能合约</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.</span> <span class="toc-text">啥是智能合约</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.</span> <span class="toc-text">EVM</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.3.</span> <span class="toc-text">DApps</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">2.</span> <span class="toc-text">DApps安装开发环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">3.</span> <span class="toc-text">安装testrpc</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">4.</span> <span class="toc-text">安装truffle</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">5.</span> <span class="toc-text">建立truffle工程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">5.1.</span> <span class="toc-text">编写智能合约</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">5.2.</span> <span class="toc-text">函数种类</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">5.3.</span> <span class="toc-text">在私有链上发布DApps</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">6.</span> <span class="toc-text">Ethereum 协议</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">7.</span> <span class="toc-text">交易</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">7.1.</span> <span class="toc-text">1. 构造交易对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">7.2.</span> <span class="toc-text">2. 为交易签名</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">7.3.</span> <span class="toc-text">3. 本地交易合法性验证</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">7.4.</span> <span class="toc-text">4. 广播合法交易</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">7.5.</span> <span class="toc-text">5. 矿工节点接受交易</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">7.6.</span> <span class="toc-text">7. 矿工</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">8.</span> <span class="toc-text">参考</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/01/05/eth-rpc-guide/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&text=ETH RPC GUIDE"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&title=ETH RPC GUIDE"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&is_video=false&description=ETH RPC GUIDE"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=ETH RPC GUIDE&body=Check out this article: http://yoursite.com/2018/01/05/eth-rpc-guide/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&title=ETH RPC GUIDE"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&title=ETH RPC GUIDE"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&title=ETH RPC GUIDE"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&title=ETH RPC GUIDE"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/01/05/eth-rpc-guide/&name=ETH RPC GUIDE&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menú</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Compartir</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Cap amunt</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 amas
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Inici</a></li>
         
          <li><a href="/about/">Qui som</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/projects_url">Projectes</a></li>
        
      </ul>
    </nav>
  </div>
</footer><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


