<!DOCTYPE html>
<html lang=zh>
<head>
    <!-- hexo-inject:begin --><!-- hexo-inject:end --><!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <meta name="description" content="Zsh Parameter Expansion 变量的定义与赋值 单引号和双引号 变量是否存在: ${+name} 或 ${+map[key]} 设置默认值但不定义变量: ${var:-value} 定义匿名变量: ${:-value} 只在未定义变量时返回默认值: ${var-value} 定义变量且返回默认值: ${var:=value} ${var::=value} 没有定义变量的时">
<meta property="og:type" content="article">
<meta property="og:title" content="Zsh Parameter Expansion">
<meta property="og:url" content="http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="Zsh Parameter Expansion 变量的定义与赋值 单引号和双引号 变量是否存在: ${+name} 或 ${+map[key]} 设置默认值但不定义变量: ${var:-value} 定义匿名变量: ${:-value} 只在未定义变量时返回默认值: ${var-value} 定义变量且返回默认值: ${var:=value} ${var::=value} 没有定义变量的时">
<meta property="og:locale" content="zh-cn">
<meta property="og:updated_time" content="2018-09-20T03:26:50.451Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Zsh Parameter Expansion">
<meta name="twitter:description" content="Zsh Parameter Expansion 变量的定义与赋值 单引号和双引号 变量是否存在: ${+name} 或 ${+map[key]} 设置默认值但不定义变量: ${var:-value} 定义匿名变量: ${:-value} 只在未定义变量时返回默认值: ${var-value} 定义变量且返回默认值: ${var:=value} ${var::=value} 没有定义变量的时">
    
    
        
          
              <link rel="shortcut icon" href="/images/favicon.ico">
          
        
        
          
            <link rel="icon" type="image/png" href="/images/favicon-192x192.png" sizes="192x192">
          
        
        
          
            <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png">
          
        
    
    <!-- title -->
    <title>Zsh Parameter Expansion</title>
    <!-- styles -->
    <link rel="stylesheet" href="/css/style.css">
    <!-- persian styles -->
    
      <link rel="stylesheet" href="/css/rtl.css">
    
    <!-- rss --><!-- hexo-inject:begin --><!-- hexo-inject:end -->
    
    
</head>

<body class="max-width mx-auto px3 ltr">
    
      <!-- hexo-inject:begin --><!-- hexo-inject:end --><div id="header-post">
  <a id="menu-icon" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
         
          <li><a href="/">Inici</a></li>
         
          <li><a href="/about/">Qui som</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/projects_url">Projectes</a></li>
        
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" href="/2018/03/27/zsh-ZshArray/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" href="/2018/03/22/javascript-play/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Post Anterior</span>
      <span id="i-next" class="info" style="display:none;">Post Següent</span>
      <span id="i-top" class="info" style="display:none;">Adalt</span>
      <span id="i-share" class="info" style="display:none;">Compartir Post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&text=Zsh Parameter Expansion"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&title=Zsh Parameter Expansion"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&is_video=false&description=Zsh Parameter Expansion"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Zsh Parameter Expansion&body=Check out this article: http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&title=Zsh Parameter Expansion"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&title=Zsh Parameter Expansion"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&title=Zsh Parameter Expansion"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&title=Zsh Parameter Expansion"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&name=Zsh Parameter Expansion&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">1.</span> <span class="toc-text">Zsh Parameter Expansion</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.</span> <span class="toc-text">变量的定义与赋值</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.1.</span> <span class="toc-text">单引号和双引号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.2.</span> <span class="toc-text">变量是否存在: ${+name} 或 ${+map[key]}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.3.</span> <span class="toc-text">设置默认值但不定义变量: ${var:-value}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.4.</span> <span class="toc-text">定义匿名变量: ${:-value}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.5.</span> <span class="toc-text">只在未定义变量时返回默认值: ${var-value}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.6.</span> <span class="toc-text">定义变量且返回默认值: ${var:=value}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.7.</span> <span class="toc-text">${var::=value}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.8.</span> <span class="toc-text">没有定义变量的时候立刻终止: ${var:!?}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.9.</span> <span class="toc-text">${var:+value}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.10.</span> <span class="toc-text">从文件中读取数据: $(&lt;file)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.11.</span> <span class="toc-text">从标准输入中读取数据: $(&lt;&amp;0)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.</span> <span class="toc-text">删除与替换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.1.</span> <span class="toc-text">${var#regex}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.2.</span> <span class="toc-text">从前删除: ${var##regex}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.3.</span> <span class="toc-text">从后删除: ${var%regex}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.4.</span> <span class="toc-text">从后删除 ${var%%regex}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.5.</span> <span class="toc-text">替换第一个匹配: ${var/regex/string}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.6.</span> <span class="toc-text">全部替换: ${var!//regex/string}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.7.</span> <span class="toc-text">压缩两个数组: ${array1:^array2} 和 ${array1:^^array2}</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.3.</span> <span class="toc-text">获取子元素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.3.1.</span> <span class="toc-text">${name:offset} 或 ${name[start]}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.3.2.</span> <span class="toc-text">${name:offset:length} 或 ${name[start,end]}</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.</span> <span class="toc-text">过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.1.</span> <span class="toc-text">${array:#regex}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.2.</span> <span class="toc-text">${(M)array:#regex}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.3.</span> <span class="toc-text">去掉重复元素: ${(u)array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.4.</span> <span class="toc-text">排列 ${^spec}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.5.</span> <span class="toc-text">${(#)var} 或 $#var</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.6.</span> <span class="toc-text">${(w)#array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.7.</span> <span class="toc-text">${(W)#array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.8.</span> <span class="toc-text">数组转化为字符串后的长度: ${(c)#array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.9.</span> <span class="toc-text">${(@)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.10.</span> <span class="toc-text">大写转换: ${(C)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.11.</span> <span class="toc-text">小写转换: ${(L)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.12.</span> <span class="toc-text">打印变量的类型: ${(t)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.13.</span> <span class="toc-text">求值并展开: ${(e)var}</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.5.</span> <span class="toc-text">排序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.5.1.</span> <span class="toc-text">${(a)array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.5.2.</span> <span class="toc-text">升序: ${(o)array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.5.3.</span> <span class="toc-text">降序: ${(O)array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.5.4.</span> <span class="toc-text">${(i)var} : 大小写不敏感的排序方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.</span> <span class="toc-text">分割与合并</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.1.</span> <span class="toc-text">${=spec}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.2.</span> <span class="toc-text">用换行回车拆分为数组: ${(f)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.3.</span> <span class="toc-text">按照shell语法进行分割: ${(z)var}:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.4.</span> <span class="toc-text">‘\0’作为分隔符: ${(0)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.5.</span> <span class="toc-text">${(s:string:)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.6.</span> <span class="toc-text">${(j:string:)array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.7.</span> <span class="toc-text">使用换行回车链接数组所有元素: ${(F)array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.8.</span> <span class="toc-text">${(k)map} : 关联数组的key集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.9.</span> <span class="toc-text">${(v)map} : 关联数组的value列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.10.</span> <span class="toc-text">${(kv)map}: 关联数组的key/value列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.11.</span> <span class="toc-text">${(n)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.12.</span> <span class="toc-text">${(nO)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.13.</span> <span class="toc-text">${(no)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.14.</span> <span class="toc-text">${(ni)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.15.</span> <span class="toc-text">${(o)var}: 升序展开</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.16.</span> <span class="toc-text">${(oi}var}: 大小写不敏感的升序展开</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.17.</span> <span class="toc-text">${(O)var}: 降序展开</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.7.</span> <span class="toc-text">二次展开: ${(P)var}</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.8.</span> <span class="toc-text">引号问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.8.1.</span> <span class="toc-text">${(q)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.8.2.</span> <span class="toc-text">${(qq)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.8.3.</span> <span class="toc-text">${(qqq)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.8.4.</span> <span class="toc-text">${(Q)var}: 去除外层引号</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.9.</span> <span class="toc-text">错误处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.9.1.</span> <span class="toc-text">${(XQ)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.9.2.</span> <span class="toc-text">${(X)var#pattern}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.9.3.</span> <span class="toc-text">${(Xe)var}</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.10.</span> <span class="toc-text">其他</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.10.1.</span> <span class="toc-text">${(p)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.10.2.</span> <span class="toc-text">${(~)var}</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.</span> <span class="toc-text">格式化打印</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.1.</span> <span class="toc-text">${(l:N:)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.2.</span> <span class="toc-text">${(r:N:)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.3.</span> <span class="toc-text">${(m)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.4.</span> <span class="toc-text">${(r:expr::string1::string2:)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.5.</span> <span class="toc-text">${(S)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.6.</span> <span class="toc-text">${(I:expr:)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.7.</span> <span class="toc-text">${(B)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.8.</span> <span class="toc-text">${(A)array=elem1 elem2 … elemeN}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.9.</span> <span class="toc-text">${(A)array:=elem1 elem2 … elemN}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.10.</span> <span class="toc-text">${(A)array::=elem1 elem2 … elemN}</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.12.</span> <span class="toc-text">${~var}</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.12.1.</span> <span class="toc-text">${(v)var}</span></a></li></ol></li></ol></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index my4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        Zsh Parameter Expansion
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">Hexo</span>
      </span>
      
    <div class="postdate">
        <time datetime="2018-03-27T03:05:09.000Z" itemprop="datePublished">2018-03-27</time>
    </div>


      

    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <div class="toc">

<!-- toc -->
<ul>
<li><a href="#zsh-parameter-expansion">Zsh Parameter Expansion</a><ul>
<li><a href="#bian-liang-de-ding-yi-yu-fu-zhi">变量的定义与赋值</a><ul>
<li><a href="#dan-yin-hao-he-shuang-yin-hao">单引号和双引号</a></li>
<li><a href="#bian-liang-shi-fou-cun-zai-name-huo-map-key">变量是否存在: ${+name} 或 ${+map[key]}</a></li>
<li><a href="#she-zhi-mo-ren-zhi-dan-bu-ding-yi-bian-liang-var-value">设置默认值但不定义变量: ${var:-value}</a></li>
<li><a href="#ding-yi-ni-ming-bian-liang-value">定义匿名变量: ${:-value}</a></li>
<li><a href="#zhi-zai-wei-ding-yi-bian-liang-shi-fan-hui-mo-ren-zhi-var-value">只在未定义变量时返回默认值: ${var-value}</a></li>
<li><a href="#ding-yi-bian-liang-qie-fan-hui-mo-ren-zhi-var-value">定义变量且返回默认值: ${var:=value}</a></li>
<li><a href="#var-value">${var::=value}</a></li>
<li><a href="#mei-you-ding-yi-bian-liang-de-shi-hou-li-ke-zhong-zhi-var">没有定义变量的时候立刻终止: ${var:!?}</a></li>
<li><a href="#var-value">${var:+value}</a></li>
<li><a href="#cong-wen-jian-zhong-du-qu-shu-ju-file">从文件中读取数据: $(&lt;file)</a></li>
<li><a href="#cong-biao-zhun-shu-ru-zhong-du-qu-shu-ju-0">从标准输入中读取数据: $(&lt;&amp;0)</a></li>
</ul>
</li>
<li><a href="#shan-chu-yu-ti-huan">删除与替换</a><ul>
<li><a href="#var-regex">${var#regex}</a></li>
<li><a href="#cong-qian-shan-chu-var-regex">从前删除: ${var##regex}</a></li>
<li><a href="#cong-hou-shan-chu-var-regex">从后删除: ${var%regex}</a></li>
<li><a href="#cong-hou-shan-chu-var-regex">从后删除 ${var%%regex}</a></li>
<li><a href="#ti-huan-di-yi-ge-pi-pei-var-regex-string">替换第一个匹配: ${var/regex/string}</a></li>
<li><a href="#quan-bu-ti-huan-var-regex-string">全部替换: ${var!//regex/string}</a></li>
<li><a href="#ya-suo-liang-ge-shu-zu-array1-array2-he-array1-array2">压缩两个数组: ${array1:^array2} 和 ${array1:^^array2}</a></li>
</ul>
</li>
<li><a href="#huo-qu-zi-yuan-su">获取子元素</a><ul>
<li><a href="#name-offset-huo-name-start">${name:offset} 或 ${name[start]}</a></li>
<li><a href="#name-offset-length-huo-name-start-end">${name:offset:length} 或 ${name[start,end]}</a></li>
</ul>
</li>
<li><a href="#guo-lu">过滤</a><ul>
<li><a href="#array-regex">${array:#regex}</a></li>
<li><a href="#m-array-regex">${(M)array:#regex}</a></li>
<li><a href="#qu-diao-chong-fu-yuan-su-u-array">去掉重复元素: ${(u)array}</a></li>
<li><a href="#pai-lie-spec">排列 ${^spec}</a></li>
<li><a href="#var-huo-var">${(#)var} 或 $#var</a></li>
<li><a href="#w-array">${(w)#array}</a></li>
<li><a href="#w-array">${(W)#array}</a></li>
<li><a href="#shu-zu-zhuan-hua-wei-zi-fu-chuan-hou-de-chang-du-c-array">数组转化为字符串后的长度: ${(c)#array}</a></li>
<li><a href="#var">${(@)var}</a></li>
<li><a href="#da-xie-zhuan-huan-c-var">大写转换: ${(C)var}</a></li>
<li><a href="#xiao-xie-zhuan-huan-l-var">小写转换: ${(L)var}</a></li>
<li><a href="#da-yin-bian-liang-de-lei-xing-t-var">打印变量的类型: ${(t)var}</a></li>
<li><a href="#qiu-zhi-bing-zhan-kai-e-var">求值并展开: ${(e)var}</a></li>
</ul>
</li>
<li><a href="#pai-xu">排序</a><ul>
<li><a href="#a-array">${(a)array}</a></li>
<li><a href="#sheng-xu-o-array">升序: ${(o)array}</a></li>
<li><a href="#jiang-xu-o-array">降序: ${(O)array}</a></li>
<li><a href="#i-var-da-xiao-xie-bu-min-gan-de-pai-xu-fang-shi">${(i)var} : 大小写不敏感的排序方式</a></li>
</ul>
</li>
<li><a href="#fen-ge-yu-he-bing">分割与合并</a><ul>
<li><a href="#spec">${=spec}</a></li>
<li><a href="#yong-huan-xing-hui-che-chai-fen-wei-shu-zu-f-var">用换行回车拆分为数组: ${(f)var}</a></li>
<li><a href="#an-zhao-shell-yu-fa-jin-xing-fen-ge-z-var">按照shell语法进行分割: ${(z)var}:</a></li>
<li><a href="#0-zuo-wei-fen-ge-fu-0-var">‘\0’作为分隔符: ${(0)var}</a></li>
<li><a href="#s-string-var">${(s:string:)var}</a></li>
<li><a href="#j-string-array">${(j:string:)array}</a></li>
<li><a href="#shi-yong-huan-xing-hui-che-lian-jie-shu-zu-suo-you-yuan-su-f-array">使用换行回车链接数组所有元素: ${(F)array}</a></li>
<li><a href="#k-map-guan-lian-shu-zu-de-key-ji">${(k)map} : 关联数组的key集</a></li>
<li><a href="#v-map-guan-lian-shu-zu-de-value-lie-biao">${(v)map} : 关联数组的value列表</a></li>
<li><a href="#kv-map-guan-lian-shu-zu-de-key-value-lie-biao">${(kv)map}: 关联数组的key/value列表</a></li>
<li><a href="#n-var">${(n)var}</a></li>
<li><a href="#no-var">${(nO)var}</a></li>
<li><a href="#no-var">${(no)var}</a></li>
<li><a href="#ni-var">${(ni)var}</a></li>
<li><a href="#o-var-sheng-xu-zhan-kai">${(o)var}: 升序展开</a></li>
<li><a href="#oi-var-da-xiao-xie-bu-min-gan-de-sheng-xu-zhan-kai">${(oi}var}: 大小写不敏感的升序展开</a></li>
<li><a href="#o-var-jiang-xu-zhan-kai">${(O)var}: 降序展开</a></li>
</ul>
</li>
<li><a href="#er-ci-zhan-kai-p-var">二次展开: ${(P)var}</a></li>
<li><a href="#yin-hao-wen-ti">引号问题</a><ul>
<li><a href="#q-var">${(q)var}</a></li>
<li><a href="#qq-var">${(qq)var}</a></li>
<li><a href="#qqq-var">${(qqq)var}</a></li>
<li><a href="#q-var-qu-chu-wai-ceng-yin-hao">${(Q)var}: 去除外层引号</a></li>
</ul>
</li>
<li><a href="#cuo-wu-chu-li">错误处理</a><ul>
<li><a href="#xq-var">${(XQ)var}</a></li>
<li><a href="#x-var-pattern">${(X)var#pattern}</a></li>
<li><a href="#xe-var">${(Xe)var}</a></li>
</ul>
</li>
<li><a href="#qi-ta">其他</a><ul>
<li><a href="#p-var">${(p)var}</a></li>
<li><a href="#var">${(~)var}</a></li>
</ul>
</li>
<li><a href="#ge-shi-hua-da-yin">格式化打印</a><ul>
<li><a href="#l-n-var">${(l:N:)var}</a></li>
<li><a href="#r-n-var">${(r:N:)var}</a></li>
<li><a href="#m-var">${(m)var}</a></li>
<li><a href="#r-expr-string1-string2-var">${(r:expr::string1::string2:)var}</a></li>
<li><a href="#s-var">${(S)var}</a></li>
<li><a href="#i-expr-var">${(I:expr:)var}</a></li>
<li><a href="#b-var">${(B)var}</a></li>
<li><a href="#a-array-elem1-elem2-elemen">${(A)array=elem1 elem2 … elemeN}</a></li>
<li><a href="#a-array-elem1-elem2-elemn">${(A)array:=elem1 elem2 … elemN}</a></li>
<li><a href="#a-array-elem1-elem2-elemn">${(A)array::=elem1 elem2 … elemN}</a></li>
</ul>
</li>
<li><a href="#var">${~var}</a><ul>
<li><a href="#v-var">${(v)var}</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- tocstop -->
<p></div></p>
<h1><span id="zsh-parameter-expansion">Zsh Parameter Expansion</span></h1><ul>
<li>Parameter即等同Variable</li>
<li>当我们说${var}时,指的是变量var的值</li>
</ul>
<h2><span id="bian-liang-de-ding-yi-yu-fu-zhi">变量的定义与赋值</span></h2><h3><span id="dan-yin-hao-he-shuang-yin-hao">单引号和双引号</span></h3><p>如果你的’value’中包含七七八八的奇怪字符,你可以使用单引号将value括起:<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;var:-'%^&amp;*()_+-=&lt;&gt;?:"&#123;&#125;</span>[];./,<span class="string">'&#125; </span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 但是如果我需要"'</span><span class="string">"该怎么办呢?</span></span><br><span class="line"><span class="string">$ tmp="</span>abcd*<span class="string">'\""</span></span><br><span class="line"><span class="string">$ echo $&#123;var:-$tmp&#125;</span></span><br></pre></td></tr></table></figure></p>
<h3><span id="bian-liang-shi-fou-cun-zai-name-huo-map-key">变量是否存在: ${+name} 或 ${+map[key]}</span></h3><p>如果已经定义了name, 则返回1, 否则返回0<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">$ x=0</span><br><span class="line">$ print $&#123;+x&#125;</span><br><span class="line">1</span><br><span class="line">$ print $&#123;+undefined&#125;</span><br><span class="line">0</span><br><span class="line"></span><br><span class="line">$ typeset -A map</span><br><span class="line">$ map[key1]=1</span><br><span class="line">$ print $&#123;+map[key1]&#125;</span><br><span class="line">1</span><br><span class="line">$ print $&#123;+map[undefined]&#125;</span><br><span class="line">0</span><br></pre></td></tr></table></figure></p>
<h3><span id="she-zhi-mo-ren-zhi-dan-bu-ding-yi-bian-liang-var-value">设置默认值但不定义变量: ${var:-value}</span></h3><ul>
<li>若var未被定义或${var}为空, 返回’value’, 否则返回${var}。</li>
<li>若var未定义，zsh也不会为你定义此变量</li>
</ul>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;var:-value&#125;</span></span><br><span class="line">value</span><br><span class="line">$ var=hola</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;var:-value&#125;</span></span><br><span class="line">hola</span><br><span class="line"></span><br><span class="line"><span class="comment"># zsh不会顺便定义此变量</span></span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;not_define:-value&#125;</span></span><br><span class="line">value</span><br><span class="line">$ (( <span class="variable">$&#123;+not_define&#125;</span> )) &amp;&amp; <span class="built_in">print</span> defined</span><br></pre></td></tr></table></figure>
<h3><span id="ding-yi-ni-ming-bian-liang-value">定义匿名变量: ${:-value}</span></h3><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;:-hello&#125;</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">print</span> -l <span class="variable">$&#123;(s::):-hello&#125;</span></span><br><span class="line">h</span><br><span class="line">e</span><br><span class="line">l</span><br><span class="line">l</span><br><span class="line">o</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;(j:-:)$&#123;(s::):-hello&#125;</span>&#125;</span><br><span class="line">h<span class="_">-e</span><span class="_">-l</span><span class="_">-l</span>-o</span><br><span class="line"></span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;(j:-:)$&#123;(Os::):-hello&#125;</span>&#125;</span><br><span class="line">o<span class="_">-l</span><span class="_">-l</span>-h<span class="_">-e</span></span><br></pre></td></tr></table></figure>
<h3><span id="zhi-zai-wei-ding-yi-bian-liang-shi-fan-hui-mo-ren-zhi-var-value">只在未定义变量时返回默认值: ${var-value}</span></h3><p>若var未定义, 返回’value’, 否则返回${var}<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># var已定义,但值为空,比较$&#123;var-value&#125;与$&#123;var:-value&#125;的输出结果</span></span><br><span class="line">$ var=<span class="string">''</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;var-value&#125;</span></span><br><span class="line"></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;var:-value&#125;</span></span><br><span class="line">value</span><br></pre></td></tr></table></figure></p>
<h3><span id="ding-yi-bian-liang-qie-fan-hui-mo-ren-zhi-var-value">定义变量且返回默认值: ${var:=value}</span></h3><p>若${var}为空或未定义, 则先定义var, 而后赋值为’value’.<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ var=<span class="string">''</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;var:=value&#125;</span> <span class="comment"># 这里包含了定义变量的操作</span></span><br><span class="line">value</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$var</span></span><br><span class="line">value</span><br></pre></td></tr></table></figure></p>
<p>我们经常利用这种形式为变量指定默认值:<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">function</span> just-do-<span class="function"><span class="title">it</span></span>() &#123;</span><br><span class="line">    <span class="comment"># 若未指定路径, 则默认使用当前路径</span></span><br><span class="line">    <span class="built_in">local</span> path=<span class="variable">$&#123;$1:=.&#125;</span></span><br><span class="line">    ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>
<h3><span id="var-value">${var::=value}</span></h3><p>总是声明var,并为其赋值为’value’, 相当于:<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">unset</span> var</span><br><span class="line">$ var=<span class="string">'value'</span></span><br></pre></td></tr></table></figure></p>
<p>这个表达式有点强劲, 它将置之既有变量定义于不顾, 完全覆盖为新的定义.</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义非空变量var</span></span><br><span class="line">$ var=<span class="string">'my god'</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 覆盖掉之前的定义</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;var::=oops&#125;</span></span><br><span class="line">oops</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$var</span></span><br><span class="line">oops</span><br><span class="line"></span><br><span class="line"><span class="comment"># ':='操作要温和的多, 它并不影响已经定义的非空变量</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;var:=hola&#125;</span></span><br><span class="line">oops</span><br></pre></td></tr></table></figure>
<h3><span id="mei-you-ding-yi-bian-liang-de-shi-hou-li-ke-zhong-zhi-var">没有定义变量的时候立刻终止: ${var:!?}</span></h3><p>如果没有定义var, 则立即终止(返回值为-1)<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;var:?&#125;</span></span><br><span class="line">zsh: var: parameter not <span class="built_in">set</span></span><br></pre></td></tr></table></figure></p>
<h3><span id="var-value">${var:+value}</span></h3><p>如果${var}非空, 则返回’value’. var的值并不会被修改.<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ var=hola</span><br><span class="line">$ echo $&#123;var:+oops&#125;</span><br><span class="line">oops</span><br><span class="line">$ echo $var</span><br><span class="line">hola</span><br></pre></td></tr></table></figure></p>
<h3><span id="cong-wen-jian-zhong-du-qu-shu-ju-lt-file">从文件中读取数据: $(&lt;file)</span></h3><h3><span id="cong-biao-zhun-shu-ru-zhong-du-qu-shu-ju-lt-amp-0">从标准输入中读取数据: $(&lt;&amp;0)</span></h3><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">$ x=$(&lt;/etc/hostname)</span><br><span class="line">localhost</span><br><span class="line"></span><br><span class="line">$ x=$(&lt;&amp;0)</span><br><span class="line">12345      <span class="comment"># 输入完成之后按C-d结束</span></span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$x</span></span><br><span class="line">12345 </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># pipe</span></span><br><span class="line">$ <span class="built_in">print</span> <span class="string">"hello pipe"</span> | <span class="function"><span class="title">function</span></span>()&#123; <span class="built_in">print</span> <span class="variable">$&#123;(U)$(&lt;&amp;0)&#125;</span>&#125;</span><br><span class="line">HELLO PIPE</span><br><span class="line">$ <span class="built_in">print</span> <span class="string">"hello pipe"</span> | ( <span class="built_in">print</span> <span class="variable">$&#123;(U)$(&lt;&amp;0)&#125;</span> )</span><br><span class="line">HELLO PIPE</span><br><span class="line">$ <span class="built_in">print</span> <span class="string">"hello pipe"</span> | &#123; <span class="built_in">print</span> <span class="variable">$&#123;(U)$(&lt;&amp;0)&#125;</span> &#125;</span><br><span class="line">HELLO PIPE</span><br></pre></td></tr></table></figure>
<h2><span id="shan-chu-yu-ti-huan">删除与替换</span></h2><h3><span id="var-regex">${var#regex}</span></h3><p>从头部保守删除符合regex的子串<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ x=<span class="string">"a.a.b.b.c.c"</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;x#*a&#125;</span></span><br><span class="line">.a.b.b.c.c</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;x#*b&#125;</span></span><br><span class="line">.b.c.c</span><br></pre></td></tr></table></figure></p>
<h3><span id="cong-qian-shan-chu-var-regex">从前删除: ${var##regex}</span></h3><p>从头部贪婪删除符合regex的子串<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ x=<span class="string">"a.a.b.b.c.c"</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;x##*a&#125;</span></span><br><span class="line">.b.b.c.c</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;x##*b&#125;</span></span><br><span class="line">.c.c</span><br></pre></td></tr></table></figure></p>
<h3><span id="cong-hou-shan-chu-var-regex">从后删除: ${var%regex}</span></h3><p>从尾部保守删除符合regex的子串</p>
<p>获取不包含后缀的文件名<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ file=README.txt</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;file%.*&#125;</span></span><br><span class="line">README</span><br></pre></td></tr></table></figure></p>
<h3><span id="cong-hou-shan-chu-var-regex">从后删除 ${var%%regex}</span></h3><p>从尾部贪婪删除符合regex的子串<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ x=README.en.txt</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;x%.*&#125;</span></span><br><span class="line">README.en</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;x%%.*&#125;</span></span><br><span class="line">README</span><br></pre></td></tr></table></figure></p>
<h3><span id="ti-huan-di-yi-ge-pi-pei-var-regex-string">替换第一个匹配: ${var/regex/string}</span></h3><p>将${var}中第一个符合regex的字串替换为string.<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ var=<span class="string">"README.en.txt"</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;var/en/zh&#125;</span></span><br><span class="line">README.zh.txt</span><br></pre></td></tr></table></figure></p>
<h3><span id="quan-bu-ti-huan-var-regex-string">全部替换: ${var!//regex/string}</span></h3><p>将${var}中全部符合regex的子串替换为string<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ x=a/b/c./d</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;x//\//.&#125;</span> </span><br><span class="line">a.b.c.d</span><br></pre></td></tr></table></figure></p>
<h3><span id="ya-suo-liang-ge-shu-zu-array1-array2-he-array1-array2">压缩两个数组: ${array1:^array2} 和 ${array1:^^array2}</span></h3><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ xs=(a b c d) ys=(1 2)</span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;xs:^ys&#125;</span></span><br><span class="line">a 1 b 2</span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;xs:^^ys&#125;</span></span><br><span class="line">a 1 b 2 c 1 d 2</span><br></pre></td></tr></table></figure>
<h2><span id="huo-qu-zi-yuan-su">获取子元素</span></h2><h3><span id="name-offset-huo-name-start">${name:offset} 或 ${name[start]}</span></h3><h3><span id="name-offset-length-huo-name-start-end">${name:offset:length} 或 ${name[start,end]}</span></h3><ul>
<li>这个方法可以用于数组或字符串</li>
<li>下标从1开始, 而非0</li>
<li>下标可以是负数, -1表示倒数第一个元素</li>
</ul>
<h2><span id="guo-lu">过滤</span></h2><h3><span id="array-regex">${array:#regex}</span></h3><p>过滤掉指定的元素<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$ xs=(aa bb ab ac)</span><br><span class="line"><span class="comment"># 过滤掉以a开头的元素</span></span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;xs:#a*&#125;</span></span><br><span class="line">bb</span><br></pre></td></tr></table></figure></p>
<h3><span id="m-array-regex">${(M)array:#regex}</span></h3><p>筛选出符合条件的元素<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ xs=(aa bb ab ac)</span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;(M)xs:#a*&#125;</span></span><br><span class="line">aa bb ac</span><br></pre></td></tr></table></figure></p>
<h3><span id="qu-diao-chong-fu-yuan-su-u-array">去掉重复元素: ${(u)array}</span></h3><p>数组以集合形式展开，重复元素只保留一个。<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$ xs=(a a c b e)</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(u)xs&#125;</span></span><br><span class="line">a c b e</span><br></pre></td></tr></table></figure></p>
<h3><span id="pai-lie-spec">排列 ${^spec}</span></h3><p>这是一个非常有趣和有用的功能, 在变量展开的时候可以暂时打开RC_EXPAND_PARAM选项. 具体使用方法是:</p>
<ul>
<li>^  : 打开RC_EXPAND_PARAM选项</li>
<li>^^ : 关闭RC_EXPAND_PARAM选项</li>
</ul>
<p>当变量展开的时候, ${^spec}将会与前后的元素进行排列.  </p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ xs=(&#123;1..10&#125;)</span><br><span class="line">$ <span class="built_in">print</span> a<span class="variable">$&#123;^xs&#125;</span></span><br><span class="line">a1 a2 a3 a4 a5 a6 a7 a8 a9 a10</span><br><span class="line">$ <span class="built_in">print</span> a<span class="variable">$&#123;^xs&#125;</span>b</span><br><span class="line">a1b a2b a3b a4b a5b a6b a7b a8b a9b a10b</span><br><span class="line">$ <span class="built_in">print</span> a<span class="variable">$&#123;^^xs&#125;</span></span><br><span class="line">a1 2 3 4 5 6 7 8 9 10</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意: 数组(xs)为空时, $&#123;^spec&#125;将导致整个结果为空.</span></span><br><span class="line">$ xs=()</span><br><span class="line">$ <span class="built_in">echo</span> HELLO<span class="variable">$&#123;xs&#125;</span>WORLD</span><br><span class="line">HELLOWORLD</span><br><span class="line">$ <span class="built_in">echo</span> HELLO<span class="variable">$&#123;^xs&#125;</span>WORLD</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">$ xs=(1 2) ys=(a b) zs=(X Y)</span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;^xs&#125;</span><span class="variable">$&#123;^ys&#125;</span><span class="variable">$&#123;^zs&#125;</span></span><br><span class="line">1aX 1aY 1bX 1bY 2aX 2aY 2bX 2bY</span><br></pre></td></tr></table></figure>
<h3><span id="var-huo-var">${(#)var} 或 $#var</span></h3><p>返回列表长度，如果是var是String则返回String的长度。</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ x=oops</span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;#x&#125;</span></span><br><span class="line">4</span><br><span class="line"></span><br><span class="line">$ xs=(&#123;1..100&#125;)</span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$#xs</span></span><br><span class="line">100</span><br></pre></td></tr></table></figure>
<h3><span id="w-array">${(w)#array}</span></h3><h3><span id="w-array">${(W)#array}</span></h3><p>统计数组中的单词个数.<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ xs=(how about <span class="string">" zsh is bad"</span>)</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$#xs</span></span><br><span class="line">3</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(w)#xs&#125;</span></span><br><span class="line">5</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(W)#xs&#125;</span></span><br><span class="line">6</span><br></pre></td></tr></table></figure></p>
<p>有关’W’的作用真是匪夷所思，比如:<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ xs=(<span class="string">" "</span> <span class="string">"  "</span>)</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(w)#xs&#125;</span></span><br><span class="line">0</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(W)#xs&#125;</span></span><br><span class="line">5</span><br><span class="line"><span class="comment"># 为什么是5?</span></span><br><span class="line"><span class="comment"># 1个空格可以分割2个词</span></span><br><span class="line"><span class="comment"># 2个空格可以分割3个词</span></span><br><span class="line"><span class="comment"># 所以最终结果为5</span></span><br></pre></td></tr></table></figure></p>
<h3><span id="shu-zu-zhuan-hua-wei-zi-fu-chuan-hou-de-chang-du-c-array">数组转化为字符串后的长度: ${(c)#array}</span></h3><p>数组中的字符数，包含分隔符（默认就是空格）。<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ xs=(H E L L O)</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$#xs</span></span><br><span class="line">5</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(c)#xs&#125;</span></span><br><span class="line">9</span><br></pre></td></tr></table></figure></p>
<h3><span id="var">${(@)var}</span></h3><p>将数组中的元素拆分成单独的词。<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ var=(a b c d e)</span><br><span class="line">$ ()&#123; <span class="built_in">print</span> <span class="string">"argc=<span class="variable">$#</span>"</span>; <span class="built_in">print</span> -l <span class="variable">$argv</span>  &#125; <span class="string">"<span class="variable">$var</span>"</span></span><br><span class="line">argc=1</span><br><span class="line">argv=a b c d e</span><br><span class="line">$ ()&#123; <span class="built_in">print</span> <span class="string">"argc=<span class="variable">$#</span>"</span>; <span class="built_in">print</span> -l <span class="variable">$argv</span>  &#125; <span class="string">"<span class="variable">$&#123;(@)var&#125;</span>"</span></span><br><span class="line">argc=5</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line">d</span><br><span class="line">e</span><br></pre></td></tr></table></figure></p>
<h3><span id="da-xie-zhuan-huan-c-var">大写转换: ${(C)var}</span></h3><p>以全部大写的方式展开变量。</p>
<h3><span id="xiao-xie-zhuan-huan-l-var">小写转换: ${(L)var}</span></h3><p>以全部小写的方式展开变量。<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ xs=(h e l l o)</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(C)xs&#125;</span></span><br><span class="line">H E L L O</span><br><span class="line">$ x=hello</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(C)hello&#125;</span></span><br><span class="line">HELLO</span><br></pre></td></tr></table></figure></p>
<h3><span id="da-yin-bian-liang-de-lei-xing-t-var">打印变量的类型: ${(t)var}</span></h3><ul>
<li>t展开可以让你了解变量的类型</li>
<li>你可以使用’typeset’或者’local’之类的指令明确指定变量类型，这并非必须，因为zsh可以自己做类型推导</li>
</ul>
<blockquote>
<p>类型 = 主类型 - 属性</p>
</blockquote>
<p>主类型可以是:</p>
<ul>
<li>scalar</li>
<li>array</li>
<li>integer</li>
<li>float</li>
<li>association</li>
</ul>
<p>其他属性可以是:</p>
<ul>
<li>local</li>
<li>left</li>
<li>right_blanks</li>
<li>right_zeros</li>
<li>lower</li>
<li>upper</li>
<li>readonly</li>
<li>tag</li>
<li>unique</li>
<li>hide</li>
<li>special : 一些具有特殊身份的变量，一般都是由shell定义的。比如: PATH</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">$ var</span><br><span class="line">$ echo $&#123;(t)var&#125;</span><br><span class="line">scalar</span><br><span class="line">$ var=(a b c)</span><br><span class="line">$ echo $&#123;(t)var&#125;</span><br><span class="line">array</span><br><span class="line"></span><br><span class="line"># 观察一下只读变量</span><br><span class="line">$ typeset -r x=1</span><br><span class="line">$ echo $&#123;(t)x&#125; </span><br><span class="line">scalar-readonly</span><br><span class="line"></span><br><span class="line">#</span><br><span class="line">$ echo $&#123;(t)PATH&#125;</span><br><span class="line">scalar-export-special</span><br><span class="line">$ echo $&#123;(t)?&#125;</span><br><span class="line">integer-readonly-special</span><br><span class="line"></span><br><span class="line"># 可以使用数组充当集合</span><br><span class="line">$ typeset -U set</span><br><span class="line">$ set=(1 1 2 2 3 3 4 5)</span><br><span class="line">$ echo $set</span><br><span class="line">1 2 3 4 5</span><br><span class="line">$ echo $&#123;(t)set&#125;</span><br><span class="line">array-unique</span><br></pre></td></tr></table></figure>
<h3><span id="qiu-zhi-bing-zhan-kai-e-var">求值并展开: ${(e)var}</span></h3><p>展开变量时执行[CommandSubstitution]和[ArithmeticExpansion]. 这种展开可以嵌套，但是层级不能太深，容易产生不可预见的效果。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">$ expr=&apos;1+2=$(( 1+2 ))&apos;</span><br><span class="line">1+2=$(( 1+2 ))</span><br><span class="line">$ echo $&#123;(e)expr&#125;</span><br><span class="line">1+2=3</span><br><span class="line"></span><br><span class="line"># 对数组也是有效的</span><br><span class="line">$ xs=(&apos;$(( 1+2 ))&apos; &apos;$((2+4))&apos; &apos;$((3+9))&apos;)</span><br><span class="line">$ echo $xs</span><br><span class="line">$(( 1+2 )) $((2+4)) $((3+9))</span><br><span class="line">$ echo $&#123;(e)xs&#125;</span><br><span class="line">3 6 12</span><br><span class="line"></span><br><span class="line"># command substitution</span><br><span class="line">$ cmd=&apos;$(echo HelloZsh)&apos;</span><br><span class="line">$ echo $cmd</span><br><span class="line">$(echo HelloZsh)</span><br><span class="line">$ echo $&#123;(e)cmd&#125;</span><br><span class="line">HelloZsh</span><br></pre></td></tr></table></figure></p>
<h2><span id="pai-xu">排序</span></h2><h3><span id="a-array">${(a)array}</span></h3><h3><span id="sheng-xu-o-array">升序: ${(o)array}</span></h3><h3><span id="jiang-xu-o-array">降序: ${(O)array}</span></h3><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ xs=(1 2 3 4 5)  </span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(a)xs&#125;</span></span><br><span class="line">1 2 3 4 5</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(O)xs&#125;</span></span><br><span class="line">5 4 3 2 1</span><br></pre></td></tr></table></figure>
<h3><span id="i-var-da-xiao-xie-bu-min-gan-de-pai-xu-fang-shi">${(i)var} : 大小写不敏感的排序方式</span></h3><p>排序时采用大小写不敏感的方式.<br><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure></p>
<h2><span id="fen-ge-yu-he-bing">分割与合并</span></h2><h3><span id="spec">${=spec}</span></h3><ul>
<li>按照<strong>SH_WORD_SPLIT</strong>的设定进行分割</li>
<li>${==spec} : 关闭分割功能</li>
</ul>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">$ x=<span class="string">"a b c"</span> </span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$x</span></span><br><span class="line">a b c</span><br><span class="line">$ <span class="built_in">print</span> -l <span class="variable">$x</span></span><br><span class="line">a b c</span><br><span class="line">$ <span class="built_in">print</span> -l <span class="variable">$&#123;=x&#125;</span></span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line">$ <span class="built_in">print</span> -l <span class="variable">$&#123;==x&#125;</span></span><br><span class="line">a b c</span><br></pre></td></tr></table></figure>
<h3><span id="yong-huan-xing-hui-che-chai-fen-wei-shu-zu-f-var">用换行回车拆分为数组: ${(f)var}</span></h3><ul>
<li>用换行回车分割输入</li>
<li>等价于<code>${(&#39;ps:\n:&#39;var)}</code></li>
</ul>
<p>num.txt:<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">1</span><br><span class="line"></span><br><span class="line">2</span><br><span class="line"></span><br><span class="line">3</span><br></pre></td></tr></table></figure></p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line">$ cat num.txt | wc -l</span><br><span class="line">5</span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意: 必须加引号</span></span><br><span class="line">$ xs=(<span class="string">"<span class="variable">$&#123;(f)$(&lt;num.txt)&#125;</span>"</span>)</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$#xs</span></span><br><span class="line">3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 空元素被滤掉了</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(F)xs&#125;</span></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 需要保留空元素</span></span><br><span class="line">$ xs=(<span class="string">"<span class="variable">$&#123;(@f)$(&lt;num.txt)&#125;</span>"</span>)</span><br><span class="line">$ <span class="built_in">print</span> -l <span class="variable">$xs</span></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line">2</span><br><span class="line"></span><br><span class="line">3</span><br></pre></td></tr></table></figure>
<h3><span id="an-zhao-shell-yu-fa-jin-xing-fen-ge-z-var">按照shell语法进行分割: ${(z)var}:</span></h3><p>按照shell的语法进行分割, 引号扩起的字符串将被作为一个完整的元素.<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">$ s=<span class="string">'"Hello world" This is not bad '</span></span><br><span class="line">$ <span class="built_in">print</span> -l <span class="variable">$&#123;(s: :)x&#125;</span></span><br><span class="line"><span class="string">"Hello</span></span><br><span class="line"><span class="string">world"</span></span><br><span class="line">This</span><br><span class="line">is</span><br><span class="line">not</span><br><span class="line">bad</span><br><span class="line">$ <span class="built_in">print</span> -l <span class="variable">$&#123;(z)x&#125;</span></span><br><span class="line"><span class="string">"Hello world"</span></span><br><span class="line">This</span><br><span class="line">is</span><br><span class="line">not</span><br><span class="line">bad</span><br></pre></td></tr></table></figure></p>
<h3><span id="0-zuo-wei-fen-ge-fu-0-var">‘\0’作为分隔符: ${(0)var}</span></h3><ul>
<li>等价于: ‘${(ps:\0:)var}’, 使用’\0’作为分隔符。</li>
</ul>
<h3><span id="s-string-var">${(s:string:)var}</span></h3><p>使用<code>string</code>分割字符串。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">$ x=&quot;a b c&quot;</span><br><span class="line">$ print -l $&#123;(s: :)x&#125;</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line"></span><br><span class="line"># 按照:分割</span><br><span class="line">$ x=&quot;a:b:c&quot;</span><br><span class="line">$ print -l $&#123;(s=:=)x&#125;</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line">c</span><br><span class="line"></span><br><span class="line"># 默认分割不保留空行</span><br><span class="line">$ x=&quot;a::c&quot;</span><br><span class="line">$ print -l $&#123;(s=:=)x&#125;</span><br><span class="line">a</span><br><span class="line">b</span><br><span class="line"></span><br><span class="line"># 保留空行</span><br><span class="line">$ print -l &quot;$&#123;(@s=:=)x&#125;&quot;</span><br><span class="line">a</span><br><span class="line"></span><br><span class="line">b</span><br></pre></td></tr></table></figure>
<h3><span id="j-string-array">${(j:string:)array}</span></h3><p>用<code>string</code>联接数组中的每个元素。</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ xs=(1 2 3)</span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;(j:-:)xs&#125;</span></span><br><span class="line">1-2-3</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用:进行链接</span></span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;(j=:=)xs&#125;</span></span><br><span class="line">1:2:3</span><br></pre></td></tr></table></figure>
<h3><span id="shi-yong-huan-xing-hui-che-lian-jie-shu-zu-suo-you-yuan-su-f-array">使用换行回车链接数组所有元素: ${(F)array}</span></h3><p>等价于<code>${(&#39;pj:\n:&#39;var)}</code>， 以’\n’作为数组展开的元素分隔符。<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ xs=(1 2 3 4 5)</span><br><span class="line">$ <span class="built_in">echo</span> <span class="string">"<span class="variable">$&#123;(F)xs&#125;</span>"</span></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用print也可以办到</span></span><br><span class="line">$ <span class="built_in">print</span> -l <span class="variable">$xs</span></span><br><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td></tr></table></figure></p>
<h3><span id="k-map-guan-lian-shu-zu-de-key-ji">${(k)map} : 关联数组的key集</span></h3><h3><span id="v-map-guan-lian-shu-zu-de-value-lie-biao">${(v)map} : 关联数组的value列表</span></h3><h3><span id="kv-map-guan-lian-shu-zu-de-key-value-lie-biao">${(kv)map}: 关联数组的key/value列表</span></h3><p>展开关联数组(map)的key列表，这个不能与下标范围同时使用， 也就是你不能指定取某个范围内的key,</p>
<figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ <span class="built_in">typeset</span> -A map</span><br><span class="line">$ map=(k1 v1 k2 v2)</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(k)map&#125;</span></span><br><span class="line">k1 k2</span><br><span class="line"></span><br><span class="line"><span class="comment"># 下标</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(k)map&#125;</span>[1] </span><br><span class="line">zsh: no matches found: k2[1]</span><br></pre></td></tr></table></figure>
<h3><span id="n-var">${(n)var}</span></h3><h3><span id="no-var">${(nO)var}</span></h3><h3><span id="no-var">${(no)var}</span></h3><h3><span id="ni-var">${(ni)var}</span></h3><ul>
<li>尽可能按照是十进制整数顺序展开</li>
<li>在元素进行比较时，如果它们之间的第一个不同的字符不是数字，则按照字典顺序展开。<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">$ xs=(001 011 012 03)</span><br><span class="line"># 按照字典顺序03是最靠后的</span><br><span class="line">$ echo $&#123;(o)xs&#125;</span><br><span class="line">001 011 012 03</span><br><span class="line"></span><br><span class="line"># 按照数字顺序，03的位置发生了变化</span><br><span class="line">$ echo $&#123;(on)xs&#125;</span><br><span class="line">001 03 011 012</span><br></pre></td></tr></table></figure>
</li>
</ul>
<h3><span id="o-var-sheng-xu-zhan-kai">${(o)var}: 升序展开</span></h3><h3><span id="oi-var-da-xiao-xie-bu-min-gan-de-sheng-xu-zhan-kai">${(oi}var}: 大小写不敏感的升序展开</span></h3><h3><span id="o-var-jiang-xu-zhan-kai">${(O)var}: 降序展开</span></h3><p>Sort the resulting words in descending order; ‘O’ without ‘a’, ‘i’ or ‘n’ sorts in reverse lexical order. May be combined with ‘a’, ‘i’ or ‘n’ to reverse the order of sorting.</p>
<h2><span id="er-ci-zhan-kai-p-var">二次展开: ${(P)var}</span></h2><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">$ x=1</span><br><span class="line">$ y=x</span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$y</span></span><br><span class="line">x</span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;(P)y&#125;</span></span><br><span class="line">1</span><br><span class="line"></span><br><span class="line"><span class="comment"># 关联数组</span></span><br><span class="line">$ <span class="built_in">typeset</span> -A map</span><br><span class="line">$ map[a]=1</span><br><span class="line">$ map[b]=2</span><br><span class="line">$ map[c]=3</span><br><span class="line">$ m=map</span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;(P)m&#125;</span>        <span class="comment">#等价于 $&#123;map&#125;</span></span><br><span class="line">1 2 3</span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;(Pkv)m&#125;</span>      <span class="comment">#等价于 $&#123;(kv)map&#125;</span></span><br><span class="line">a 1 b 2 c 3</span><br><span class="line">$ <span class="built_in">print</span> <span class="variable">$&#123;$&#123;(P)m&#125;</span>[a]&#125;  <span class="comment">#等价于 $map[a]</span></span><br><span class="line">1</span><br></pre></td></tr></table></figure>
<h2><span id="yin-hao-wen-ti">引号问题</span></h2><h3><span id="q-var">${(q)var}</span></h3><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ x=<span class="string">"hello\nzsh"</span></span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$x</span></span><br><span class="line">hello</span><br><span class="line">zsh</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(q)x&#125;</span></span><br><span class="line">hello\nzsh</span><br></pre></td></tr></table></figure>
<h3><span id="qq-var">${(qq)var}</span></h3><h3><span id="qqq-var">${(qqq)var}</span></h3><p>Quote the resulting words with backslashes; unprintable or invalid characters are quoted using the $’\NNN’ form, with separate quotes for each octet. If this flag is given twice, the resulting words are quoted in single quotes and if it is given three times, the words are quoted in double quotes; in these forms no special handling of unprintable or invalid characters is attempted. If the flag is given four times, the words are quoted in single quotes preceded by a $.</p>
<h3><span id="q-var-qu-chu-wai-ceng-yin-hao">${(Q)var}: 去除外层引号</span></h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ x=&apos;&quot;egg&quot;&apos;</span><br><span class="line">$ echo $x</span><br><span class="line">&quot;egg&quot;</span><br><span class="line">$ echo $&#123;(Q)x&#125;</span><br><span class="line">egg</span><br></pre></td></tr></table></figure>
<h2><span id="cuo-wu-chu-li">错误处理</span></h2><h3><span id="xq-var">${(XQ)var}</span></h3><h3><span id="x-var-pattern">${(X)var#pattern}</span></h3><h3><span id="xe-var">${(Xe)var}</span></h3><p>这个用于改变e,#,Q展开时遇到错误改如何是好, 加上X出现错误不会默认被或略掉<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ x=&apos;&quot;abc&apos;</span><br><span class="line">$ print $&#123;(Q)x&#125;</span><br><span class="line">&quot;abc</span><br><span class="line">$ print $&#123;(XQ)x&#125;</span><br><span class="line">zsh: unmatched &quot;</span><br></pre></td></tr></table></figure></p>
<h2><span id="qi-ta">其他</span></h2><h3><span id="p-var">${(p)var}</span></h3><p>Recognize the same escape sequences as the print builtin in string<br>arguments to any of the flags described below that follow this argument.</p>
<h3><span id="var">${(~)var}</span></h3><p>Force string arguments to any of the flags below that follow within the parentheses<br> to be treated as patterns.<br> Compare with a ~ outside parentheses,<br> which forces the entire substituted string to be treated as a pattern.<br>  Hence, for example,</p>
<p>[[ “?” = ${(~j.|.)array} ]]<br>with the EXTENDED_GLOB option set succeeds if and only if $array contains the string ‘?’ as an element.<br>The argument may be repeated to toggle the behaviour; its effect only lasts to the end of the parenthesised group.</p>
<h2><span id="ge-shi-hua-da-yin">格式化打印</span></h2><h3><span id="l-n-var">${(l:N:)var}</span></h3><h3><span id="r-n-var">${(r:N:)var}</span></h3><ul>
<li>l : 左留白</li>
<li>r : 右留白</li>
<li>N : 显示宽度,单位是字符数,如果变量的内容超过N则会发生截断</li>
</ul>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">$ x=&quot;123456&quot;</span><br><span class="line">$ print &quot;&apos;$&#123;(l:10:)x&#125;&apos;&quot;</span><br><span class="line">&apos;    123456&apos;</span><br><span class="line">$ print &quot;&apos;$&#123;(r:10:)x&#125;&apos;&quot;</span><br><span class="line">&apos;123456    &apos;</span><br><span class="line">$ print &quot;&apos;$&#123;(l:4:)x&#125;&apos;&quot;</span><br><span class="line">&apos;3456&apos;</span><br><span class="line">$ print &quot;&apos;$&#123;(r:4:)x&#125;&apos;&quot;</span><br><span class="line">&apos;1234&apos;</span><br></pre></td></tr></table></figure>
<h3><span id="m-var">${(m)var}</span></h3><h3><span id="r-expr-string1-string2-var">${(r:expr::string1::string2:)var}</span></h3><p>As l, but pad the words on the right and insert string2 immediately to the right of the string to be padded.<br>Left and right padding may be used together. In this case the strategy is to apply left padding to the first half width of each of the resulting words, and right padding to the second half. If the string to be padded has odd width the extra padding is applied on the left.</p>
<h3><span id="s-var">${(S)var}</span></h3><p>Search substrings as well as beginnings or ends; with # start from the beginning and with % start from the end of the string. With substitution via ${…/…} or ${…//…}, specifies non-greedy matching, i.e. that the shortest instead of the longest match should be replaced.</p>
<h3><span id="i-expr-var">${(I:expr:)var}</span></h3><p>Search the exprth match (where expr evaluates to a number). This only applies when searching for substrings, either with the S flag, or with ${…/…} (only the exprth match is substituted) or ${…//…} (all matches from the exprth on are substituted). The default is to take the first match.<br>The exprth match is counted such that there is either one or zero matches from each starting position in the string, although for global substitution matches overlapping previous replacements are ignored. With the ${…%…} and ${…%%…} forms, the starting position for the match moves backwards from the end as the index increases, while with the other forms it moves forward from the start.<br>Hence with the string</p>
<p>which switch is the right switch for Ipswich?<br>substitutions of the form ${(SI:N:)string#w*ch} as N increases from 1 will match and remove ‘which’, ‘witch’, ‘witch’ and ‘wich’; the form using ‘##’ will match and remove ‘which switch is the right switch for Ipswich’, ‘witch is the right switch for Ipswich’, ‘witch for Ipswich’ and ‘wich’. The form using ‘%’ will remove the same matches as for ‘#’, but in reverse order, and the form using ‘%%’ will remove the same matches as for ‘##’ in reverse order.</p>
<h3><span id="b-var">${(B)var}</span></h3><p>Include the index of the beginning of the match in the result.</p>
<p>=== ${(E)var}</p>
<p>Include the index of the end of the match in the result.</p>
<p>=== ${(M)var}</p>
<p>Include the matched portion in the result.</p>
<p>=== ${(N)var}</p>
<p>Include the length of the match in the result.</p>
<p>=== ${(R)var}</p>
<p>Include the unmatched portion in the result (the Rest).</p>
<p>== 代换规则(substitutions rule)</p>
<p>Here is a summary of the rules for substitution; this assumes that braces are present around the substitution, i.e. ${…}. Some particular examples are given below. Note that the Zsh Development Group accepts no responsibility for any brain damage which may occur during the reading of the following rules.<br>=== 1. Nested Substitution<br>If multiple nested ${…} forms are present, substitution is performed from the inside outwards. At each level, the substitution takes account of whether the current value is a scalar or an array, whether the whole substitution is in double quotes, and what flags are supplied to the current level of substitution, just as if the nested substitution were the outermost. The flags are not propagated up to enclosing substitutions; the nested substitution will return either a scalar or an array as determined by the flags, possibly adjusted for quoting. All the following steps take place where applicable at all levels of substitution. Note that, unless the ‘(P)’ flag is present, the flags and any subscripts apply directly to the value of the nested substitution; for example, the expansion ${${foo}} behaves exactly the same as ${foo}.<br>At each nested level of substitution, the substituted words undergo all forms of single-word substitution (i.e. not filename generation), including command substitution, arithmetic expansion and filename expansion (i.e. leading ~ and =). Thus, for example, ${${:-=cat}:h} expands to the directory where the cat program resides. (Explanation: the internal substitution has no parameter but a default value =cat, which is expanded by filename expansion to a full path; the outer substitution then applies the modifier :h and takes the directory part of the path.)<br>=== 2. Internal Parameter Flags<br>Any parameter flags set by one of the typeset family of commands, in particular the L, R, Z, u and l flags for padding and capitalization, are applied directly to the parameter value.<br>=== 3. Parameter Subscripting<br>If the value is a raw parameter reference with a subscript, such as ${var[3]}, the effect of subscripting is applied directly to the parameter. Subscripts are evaluated left to right; subsequent subscripts apply to the scalar or array value yielded by the previous subscript. Thus if var is an array, ${var[1][2]} is the second character of the first word, but ${var[2,4][2]} is the entire third word (the second word of the range of words two through four of the original array). Any number of subscripts may appear.<br>=== 4. Parameter Name Replacement<br>The effect of any (P) flag, which treats the value so far as a parameter name and replaces it with the corresponding value, is applied.<br>=== 5. Double-Quoted Joining<br>If the value after this process is an array, and the substitution appears in double quotes, and no (@) flag is present at the current level, the words of the value are joined with the first character of the parameter $IFS, by default a space, between each word (single word arrays are not modified). If the (j) flag is present, that is used for joining instead of $IFS.<br>=== 6. Nested Subscripting<br>Any remaining subscripts (i.e. of a nested substitution) are evaluated at this point, based on whether the value is an array or a scalar. As with 2., multiple subscripts can appear. Note that ${foo[2,4][2]} is thus equivalent to ${${foo[2,4]}[2]} and also to “${${(@)foo[2,4]}[2]}” (the nested substitution returns an array in both cases), but not to “${${foo[2,4]}[2]}” (the nested substitution returns a scalar because of the quotes).<br>=== 7. Modifiers<br>Any modifiers, as specified by a trailing ‘#’, ‘%’, ‘/‘ (possibly doubled) or by a set of modifiers of the form :… (see the section ‘Modifiers’ in the section ‘History Expansion’), are applied to the words of the value at this level.<br>=== 8. Forced Joining<br>If the ‘(j)’ flag is present, or no ‘(j)’ flag is present but the string is to be split as given by rules 8. or 9., and joining did not take place at step 4., any words in the value are joined together using the given string or the first character of $IFS if none. Note that the ‘(F)’ flag implicitly supplies a string for joining in this manner.<br>=== 9. Forced Splitting<br>If one of the ‘(s)’, ‘(f)’ or ‘(z)’ flags are present, or the ‘=’ specifier was present (e.g. ${=var}), the word is split on occurrences of the specified string, or (for = with neither of the two flags present) any of the characters in $IFS.<br>=== 10. Shell Word Splitting<br>If no ‘(s)’, ‘(f)’ or ‘=’ was given, but the word is not quoted and the option SH_WORD_SPLIT is set, the word is split on occurrences of any of the characters in $IFS. Note this step, too, takes place at all levels of a nested substitution.<br>=== 11. Uniqueness<br>If the result is an array and the ‘(u)’ flag was present, duplicate elements are removed from the array.<br>=== 12. Ordering<br>If the result is still an array and one of the ‘(o)’ or ‘(O)’ flags was present, the array is reordered.<br>=== 13. Re-Evaluation: 小e展开<br>Any ‘(e)’ flag is applied to the value, forcing it to be re-examined for new parameter substitutions, but also for command and arithmetic substitutions.<br>=== 14. Padding<br>Any padding of the value by the ‘(l.fill.)’ or ‘(r.fill.)’ flags is applied.<br>=== 15. Semantic Joining<br>In contexts where expansion semantics requires a single word to result, all words are rejoined with the first character of IFS between. So in ‘${(P)${(f)lines}}’ the value of ${lines} is split at newlines, but then must be joined again before the P flag can be applied.<br>If a single word is not required, this rule is skipped.</p>
<p>Examples</p>
<p>The flag f is useful to split a double-quoted substitution line by line. For example, ${(f)”$(&lt;file)”} substitutes the contents of file divided so that each line is an element of the resulting array. Compare this with the effect of $(&lt;file) alone, which divides the file up by words, or the same inside double quotes, which makes the entire content of the file a single string.<br>The following illustrates the rules for nested parameter expansions. Suppose that $foo contains the array (bar baz):</p>
<p>“${(@)${foo}[1]}”<br>This produces the result b. First, the inner substitution “${foo}”, which has no array (@) flag, produces a single word result “bar baz”. The outer substitution “${(@)…[1]}” detects that this is a scalar, so that (despite the ‘(@)’ flag) the subscript picks the first character.<br>“${${(@)foo}[1]}”<br>This produces the result ‘bar’. In this case, the inner substitution “${(@)foo}” produces the array ‘(bar baz)’. The outer substitution “${…[1]}” detects that this is an array and picks the first word. This is similar to the simple case “${foo[1]}”.<br>As an example of the rules for word splitting and joining, suppose $foo contains the array ‘(ax1 bx1)’. Then<br>${(s/x/)foo}<br>produces the words ‘a’, ‘1 b’ and ‘1’.<br>${(j/x/s/x/)foo}<br>produces ‘a’, ‘1’, ‘b’ and ‘1’.<br>${(s/x/)foo%%1*}<br>produces ‘a’ and ‘ b’ (note the extra space). As substitution occurs before either joining or splitting, the operation first generates the modified array (ax bx), which is joined to give “ax bx”, and then split to give ‘a’, ‘ b’ and ‘’. The final empty string will then be elided, as it is not in double quotes.</p>
<p>}}}<br>从这里开始，flag可以接收额外的参数， 这些参数默认以’:…:’作为分割符，除了小p之外，任何相同的字符(‘a…a’, ‘x…x’)，或者符号对儿(比如: ‘(…)’, ‘[…]’, ‘&lt;…&gt;’)都可以作为分隔符。</p>
<p>这里面的’…’为一个参数，如果有多个参数，必须确保所有的参数都被分隔符包围。</p>
<p>你可能注意到，它们的效果都是一样的:<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ x=(1 2 3)</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(j:--:)x&#125;</span></span><br><span class="line">1--2--3</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(ja--a)x&#125;</span></span><br><span class="line">1--2--3</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;(j&#123;--&#125;</span>)x&#125;</span><br><span class="line">1--2--3</span><br></pre></td></tr></table></figure></p>
<h3><span id="a-array-elem1-elem2-elemen">${(A)array=elem1 elem2 … elemeN}</span></h3><h3><span id="a-array-elem1-elem2-elemn">${(A)array:=elem1 elem2 … elemN}</span></h3><h3><span id="a-array-elem1-elem2-elemn">${(A)array::=elem1 elem2 … elemN}</span></h3><p>有关’…=…’,<code>...:=...</code>,<code>...::=...</code>的使用方法请参看前面的章节，经过<code>A</code>修饰后，将建立数组变量。</p>
<h2><span id="var">${~var}</span></h2><p>允许FileGlobbing.<br><figure class="highlight zsh"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">$ ls</span><br><span class="line">dir1 dir2</span><br><span class="line">$ var=*</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$var</span></span><br><span class="line">*</span><br><span class="line">$ <span class="built_in">echo</span> <span class="variable">$&#123;~var&#125;</span></span><br><span class="line">dir1 dir2</span><br></pre></td></tr></table></figure></p>
<h3><span id="v-var">${(v)var}</span></h3><p>Make any special characters in the resulting words visible.</p>

  </div>
</article>



    </div>
    
      <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Inici</a></li>
         
          <li><a href="/about/">Qui som</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/projects_url">Projectes</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#undefined"><span class="toc-number">1.</span> <span class="toc-text">Zsh Parameter Expansion</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.</span> <span class="toc-text">变量的定义与赋值</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.1.</span> <span class="toc-text">单引号和双引号</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.2.</span> <span class="toc-text">变量是否存在: ${+name} 或 ${+map[key]}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.3.</span> <span class="toc-text">设置默认值但不定义变量: ${var:-value}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.4.</span> <span class="toc-text">定义匿名变量: ${:-value}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.5.</span> <span class="toc-text">只在未定义变量时返回默认值: ${var-value}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.6.</span> <span class="toc-text">定义变量且返回默认值: ${var:=value}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.7.</span> <span class="toc-text">${var::=value}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.8.</span> <span class="toc-text">没有定义变量的时候立刻终止: ${var:!?}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.9.</span> <span class="toc-text">${var:+value}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.10.</span> <span class="toc-text">从文件中读取数据: $(&lt;file)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.1.11.</span> <span class="toc-text">从标准输入中读取数据: $(&lt;&amp;0)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.</span> <span class="toc-text">删除与替换</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.1.</span> <span class="toc-text">${var#regex}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.2.</span> <span class="toc-text">从前删除: ${var##regex}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.3.</span> <span class="toc-text">从后删除: ${var%regex}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.4.</span> <span class="toc-text">从后删除 ${var%%regex}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.5.</span> <span class="toc-text">替换第一个匹配: ${var/regex/string}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.6.</span> <span class="toc-text">全部替换: ${var!//regex/string}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.2.7.</span> <span class="toc-text">压缩两个数组: ${array1:^array2} 和 ${array1:^^array2}</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.3.</span> <span class="toc-text">获取子元素</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.3.1.</span> <span class="toc-text">${name:offset} 或 ${name[start]}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.3.2.</span> <span class="toc-text">${name:offset:length} 或 ${name[start,end]}</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.</span> <span class="toc-text">过滤</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.1.</span> <span class="toc-text">${array:#regex}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.2.</span> <span class="toc-text">${(M)array:#regex}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.3.</span> <span class="toc-text">去掉重复元素: ${(u)array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.4.</span> <span class="toc-text">排列 ${^spec}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.5.</span> <span class="toc-text">${(#)var} 或 $#var</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.6.</span> <span class="toc-text">${(w)#array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.7.</span> <span class="toc-text">${(W)#array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.8.</span> <span class="toc-text">数组转化为字符串后的长度: ${(c)#array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.9.</span> <span class="toc-text">${(@)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.10.</span> <span class="toc-text">大写转换: ${(C)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.11.</span> <span class="toc-text">小写转换: ${(L)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.12.</span> <span class="toc-text">打印变量的类型: ${(t)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.4.13.</span> <span class="toc-text">求值并展开: ${(e)var}</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.5.</span> <span class="toc-text">排序</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.5.1.</span> <span class="toc-text">${(a)array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.5.2.</span> <span class="toc-text">升序: ${(o)array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.5.3.</span> <span class="toc-text">降序: ${(O)array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.5.4.</span> <span class="toc-text">${(i)var} : 大小写不敏感的排序方式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.</span> <span class="toc-text">分割与合并</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.1.</span> <span class="toc-text">${=spec}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.2.</span> <span class="toc-text">用换行回车拆分为数组: ${(f)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.3.</span> <span class="toc-text">按照shell语法进行分割: ${(z)var}:</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.4.</span> <span class="toc-text">‘\0’作为分隔符: ${(0)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.5.</span> <span class="toc-text">${(s:string:)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.6.</span> <span class="toc-text">${(j:string:)array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.7.</span> <span class="toc-text">使用换行回车链接数组所有元素: ${(F)array}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.8.</span> <span class="toc-text">${(k)map} : 关联数组的key集</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.9.</span> <span class="toc-text">${(v)map} : 关联数组的value列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.10.</span> <span class="toc-text">${(kv)map}: 关联数组的key/value列表</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.11.</span> <span class="toc-text">${(n)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.12.</span> <span class="toc-text">${(nO)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.13.</span> <span class="toc-text">${(no)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.14.</span> <span class="toc-text">${(ni)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.15.</span> <span class="toc-text">${(o)var}: 升序展开</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.16.</span> <span class="toc-text">${(oi}var}: 大小写不敏感的升序展开</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.6.17.</span> <span class="toc-text">${(O)var}: 降序展开</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.7.</span> <span class="toc-text">二次展开: ${(P)var}</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.8.</span> <span class="toc-text">引号问题</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.8.1.</span> <span class="toc-text">${(q)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.8.2.</span> <span class="toc-text">${(qq)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.8.3.</span> <span class="toc-text">${(qqq)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.8.4.</span> <span class="toc-text">${(Q)var}: 去除外层引号</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.9.</span> <span class="toc-text">错误处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.9.1.</span> <span class="toc-text">${(XQ)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.9.2.</span> <span class="toc-text">${(X)var#pattern}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.9.3.</span> <span class="toc-text">${(Xe)var}</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.10.</span> <span class="toc-text">其他</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.10.1.</span> <span class="toc-text">${(p)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.10.2.</span> <span class="toc-text">${(~)var}</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.</span> <span class="toc-text">格式化打印</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.1.</span> <span class="toc-text">${(l:N:)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.2.</span> <span class="toc-text">${(r:N:)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.3.</span> <span class="toc-text">${(m)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.4.</span> <span class="toc-text">${(r:expr::string1::string2:)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.5.</span> <span class="toc-text">${(S)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.6.</span> <span class="toc-text">${(I:expr:)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.7.</span> <span class="toc-text">${(B)var}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.8.</span> <span class="toc-text">${(A)array=elem1 elem2 … elemeN}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.9.</span> <span class="toc-text">${(A)array:=elem1 elem2 … elemN}</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.11.10.</span> <span class="toc-text">${(A)array::=elem1 elem2 … elemN}</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#undefined"><span class="toc-number">1.12.</span> <span class="toc-text">${~var}</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#undefined"><span class="toc-number">1.12.1.</span> <span class="toc-text">${(v)var}</span></a></li></ol></li></ol></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" href="http://www.facebook.com/sharer.php?u=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://twitter.com/share?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&text=Zsh Parameter Expansion"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.linkedin.com/shareArticle?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&title=Zsh Parameter Expansion"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://pinterest.com/pin/create/bookmarklet/?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&is_video=false&description=Zsh Parameter Expansion"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=Zsh Parameter Expansion&body=Check out this article: http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="https://getpocket.com/save?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&title=Zsh Parameter Expansion"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://reddit.com/submit?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&title=Zsh Parameter Expansion"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.stumbleupon.com/submit?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&title=Zsh Parameter Expansion"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://digg.com/submit?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&title=Zsh Parameter Expansion"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="http://www.tumblr.com/share/link?url=http://yoursite.com/2018/03/27/zsh-ZshParameterExpansion/&name=Zsh Parameter Expansion&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menú</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Compartir</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Cap amunt</a>
    </div>

  </div>
</div>

    
    <footer id="footer">
  <div class="footer-left">
    Copyright &copy; 2018 amas
  </div>
  <div class="footer-right">
    <nav>
      <ul>
         
          <li><a href="/">Inici</a></li>
         
          <li><a href="/about/">Qui som</a></li>
         
          <li><a href="/archives/">Articles</a></li>
         
          <li><a href="/projects_url">Projectes</a></li>
        
      </ul>
    </nav>
  </div>
</footer><!-- hexo-inject:begin --><!-- hexo-inject:end -->

</body>
</html>
<!-- styles -->
<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">
<link rel="stylesheet" href="/lib/justified-gallery/css/justifiedGallery.min.css">

<!-- jquery -->
<script src="/lib/jquery/jquery.min.js"></script>
<script src="/lib/justified-gallery/js/jquery.justifiedGallery.min.js"></script>
<script src="/js/main.js"></script>
<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Disqus Comments -->


